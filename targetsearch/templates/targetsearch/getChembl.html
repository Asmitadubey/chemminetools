{% extends "base.html" %}
{% load cms_tags %}


{% block base_content %}

	<div class="row">
	<div class="col-md-12">
	<form method="GET">
	<div class="form-group">
		<label for="accession_id">Accession ID:</label>
		<small class="form-text text-muted">To perform multiple searches, separate search terms with spaces.</small>
		<br>
		<textarea id="accession_id" name="accession_id" rows="10" class="form-control" placeholder="Enter accession ID(s)"></textarea>
	</div>
	<div class="form-group">
		<button type="submit" class="btn btn-primary">Search</button>
	</div>
	</form>
	</div>
	</div>
	{% if query_submit %}
	{% for accession_id in accession_id_tuple %}
		<div class="row">
		<div class="col-md-12">
		<h3>Matching ChEMBL IDs ({{ accession_id }}):</h3>
		<table class="table table-striped result-table" style="display:none">
		<thead>
			<tr>
				<th>ChEMBL IDs</th>
				<th>Entity Type</th>
			</tr>
		</thead>
		<tbody>
		{% for match in matches|dict_lookup:accession_id %}
			<tr>
				<td><a target="_blank" href="https://www.ebi.ac.uk/chembl/compound_report_card/{{ match.chembl_id }}/">{{ match.chembl_id }}</a></td>
				<td>{{match.entity_type}}</td>
			</tr>
		{% empty %}
			<tr>
				<td>No matching ChEMBL IDs.</td>
				<td></td>
			</tr>
		{% endfor %}
		</tbody>
		</table>
		</div>
		</div>
	{% endfor %}
	{% endif %}
{% endblock base_content %}



{% block js_content %}
<!--
<script type="text/javascript" src="/static/admin/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="/static/admin/dt_bootstrap/dataTables.bootstrap.js"></script>

-->

<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/dt-1.10.18/b-1.5.6/b-html5-1.5.6/b-print-1.5.6/datatables.min.css"/>
<script type="text/javascript" src="https://cdn.datatables.net/v/dt/dt-1.10.18/b-1.5.6/b-html5-1.5.6/b-print-1.5.6/datatables.min.js"></script>


<script type="text/javascript">
$(document).ready(function() {
	$('.result-table').dataTable( {
		dom: 'Bfrtip',
		buttons: ['csv',
			{
				text: "All Results",
				action: function(e,dt,node,config){
					dt.search("").draw();
				},
			},

			{
				text: "Compounds Only",
				action: function(e,dt,node,config){
					dt.search("COMPOUND").draw();

				},
			},
		],
		initComplete: function(){
			$('.result-table').show();
		},
         } );
} );
</script>

{% endblock %}


