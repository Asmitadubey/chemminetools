{% load targetsearch_extras %}

{% include "targetsearch/csm.html" %}

<div class="row">
	<div class="col-md-12">
		<h4>By {{table_name.title}}</h4>
		<div class="btn-toolbar" role="toolbar" aria-label="Button toolbar for {{table_name}} table">
			<div class="btn-group mr-1" role="group">
				<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#csm{{table_name.title}}">Show/Hide Columns</button>
			</div>
			<div class="btn-group mr-1" role="group">
				<button id="csv{{table_name.title}}" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Save to CSV</button>
				<div id="csv-buttons-{{table_name}}" class="dropdown-menu" aria-labelledby="csv{{table_name.title}}"></div>
			</div>
			<div class="btn-group mr-1" role="group">
				<button id="rowSel{{table_name.title}}" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Select Rows</button>
				<div class="dropdown-menu" aria-labelledby="rowSel{{table_name.title}}">
					<div class="btn-group-vertical">
						<button type="button" class="btn btn-secondary" onClick="targetSearch.{{table_name}}_table.rows().select()">All</button>
						<button type="button" class="btn btn-secondary" onClick="targetSearch.{{table_name}}_table.rows().deselect()">None</button>
						<button type="button" class="btn btn-secondary mt-1" disabled>Unique Compounds</button>
						<button type="button" class="btn btn-secondary" disabled>Compounds Not in Workbench</button>
						<button type="button" class="btn btn-secondary mt-1" onClick="targetSearch.{{table_name}}_table.select.style('api')">Disable Select</button>
						<button type="button" class="btn btn-secondary" onClick="targetSearch.{{table_name}}_table.select.style('multi')">Enable Select</button>
					</div>
				</div>
			</div>
			<div class="btn-group mr-1" role="group">
				<button id="selRowAct{{table_name.title}}" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Selected Row Actions</button>
				<div class="dropdown-menu" aria-labelledby="selRowAct{{table_name.title}}">
					<div class="btn-group-vertical">
						<button type="button" class="btn btn-secondary" onClick="showWorkbenchModal('{{table_name}}')">Add Compounds to Workbench</button>
						<button type="button" class="btn btn-secondary" onclick="addIdToSearch('{{table_name}}','chembl')">Add Compound IDs to Search</button>
						<button type="button" class="btn btn-secondary" onclick="addIdToSearch('{{table_name}}','accession')">Add Accession IDs to Search</button>
					</div>
				</div>
			</div>
		</div>
		<table class="table table-striped" id="{{table_name}}-table">
			<thead>
				<tr>
					{% for col in table_info %}
					<th>{{col.name}}</th>
					{% endfor %}
				</tr>
			</thead>
			<tbody>
				{% for key, rows in table_data.items %}
					{% for row in rows %}
					<tr>
						{% for col in table_info %}
							{% dict_lookup row col.id as cell_value %}
							{% if 'html' in col.keys %}
								<td>{% html_format col.html cell_value %}</td>
							{% elif 'url' in col.keys %}
								<td><a target="_blank" href="{% url_format col.url cell_value %}">{{ cell_value }}</a></td>
							{% else %}
								<td>{{ cell_value }}</td>
							{% endif %}
						{% endfor %}
					</tr>
					{% endfor %}
				{% endfor %}
			</tbody>
		</table>
	</div>
</div>
